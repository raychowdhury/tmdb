<div class="movie-list-container">
  <!-- Filter Section -->
  <div class="filter-section">
    <div class="search-bar">
      <input
        type="text"
        placeholder="Search for a movie..."
        [(ngModel)]="searchTerm"
        (input)="onSearchInputChange()"
      />
    </div>

    <div class="genre-filter">
      <label for="genre-select">Filter by Genre:</label>
      <select id="genre-select" [(ngModel)]="selectedGenre" (change)="onFilterChange()">
        <option value="All">All</option>
        <option *ngFor="let genre of genres" [value]="genre.name">{{ genre.name }}</option>
      </select>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="!filteredMovies.length && genres.length > 0">
    <p>Loading movies...</p>
  </div>

  <!-- Display Filtered Movies -->
  <div *ngIf="filteredMovies.length > 0; else noMovies" class="movies-section">
    <!-- Dynamic Heading -->
    <h2>
      <ng-container *ngIf="searchTerm.trim() !== ''; else genreHeading">
        Search Results for "{{ searchTerm }}"
      </ng-container>
      <ng-template #genreHeading>
        <ng-container *ngIf="selectedGenre !== 'All'">
          {{ selectedGenre }} Movies
        </ng-container>
        <ng-container *ngIf="selectedGenre === 'All'">
          All Movies
        </ng-container>
      </ng-template>
    </h2>

    <!-- Movies Grid -->
    <div class="movies-grid">
      <app-movie-card
        *ngFor="let movie of filteredMovies"
        [movie]="movie"
        [isInWatchlist]="watchlistMovieIds.has(movie.id)"
        (addMovie)="addMovie(movie)"
        (removeMovie)="removeMovie(movie)"
        (navigateToDetails)="goToMovieDetails(movie.id)"
      ></app-movie-card>
    </div>
  </div>

  <!-- No Movies Found Template -->
  <ng-template #noMovies>
    <p>No movies found.</p>
  </ng-template>

  <!-- Message Popup -->
  <div *ngIf="showMessage" class="message-popup">
    {{ message }}
  </div>
</div>
